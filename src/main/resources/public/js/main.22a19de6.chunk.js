(this["webpackJsonparchitect-notes"]=this["webpackJsonparchitect-notes"]||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(55),o=n.n(c),l=n(2),u=n(7),i=n(13),s=n(3),b=n(1),m=n(10),d=n.n(m),f=n(56),p=n.n(f),v={get:function(){return Promise.reject()},post:function(){return Promise.reject()},put:function(){return Promise.reject()},delete:function(){return Promise.reject()}},h=function(e){v=p.a.create({baseURL:"http://".concat(window.location.host,"/api"),paramsSerializer:d.a.stringify,headers:{Authorization:"Bearer ".concat(e)}})},E=function(){return v.get("topics").then((function(e){return e.data}))},j=function(e){return v.get("knowledgeblocks/".concat(encodeURI(e))).then((function(e){return e.data}))},O=function(e){return v.post("knowledgeblocks",e)},g=function(e){return v.put("knowledgeblocks",e)},k=function(){return v.get("/user/votes").then((function(e){return e.data}))},w=n(33),S=function(e){var t=[];return e.topicList.forEach((function(e){if(e.parentId){var n=t.findIndex((function(t){return t.id===e.parentId}));void 0!==n&&t.splice(n+1,0,Object(w.a)({},e,{title:e.title.trim(),depth:t[n].depth+1}))}else t.push(Object(w.a)({},e,{title:e.title.trim(),depth:0}))})),t},y=["entry","medium","advanced"],x=function(e){var t=e.loadingState,n=e.children,a=e.withTokenLink;return r.a.createElement(r.a.Fragment,null,"success"===t?n:r.a.createElement("p",null,r.a.createElement("em",null,"loading"===t?"Loading...":"An error ocurred :("),"error"===t&&a&&r.a.createElement("p",null,"If you think this might be due to a token error, please click"," ",r.a.createElement(u.b,{to:"/token"},"here"))))},C=n(58),I=n.n(C),L=n(59);function P(){var e=Object(l.a)(["\n  * {\n    max-width: 100%;\n  }\n"]);return P=function(){return e},e}var T=s.b.div(P()),A=Object(a.memo)((function(e){var t=e.input;return r.a.createElement(T,{dangerouslySetInnerHTML:{__html:Object(L.sanitize)(I()(t))}})})),R=n(63),U=n.n(R);function z(){var e=Object(l.a)(["\n  width: 640px;\n  height: 360px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  background: black;\n  color: white;\n"]);return z=function(){return e},e}function B(){var e=Object(l.a)(["\n  margin-top: 20px;\n  display: flex;\n  justify-content: center;\n"]);return B=function(){return e},e}var V=s.b.div(B()),_=s.b.div(z()),D=function(e){var t=e.split(":"),n=Object(b.a)(t,3),a=n[0],r=n[1],c=n[2];return 60*parseInt(a,10)*60+60*parseInt(r,10)+parseInt(c,10)},F=Object(a.memo)((function(e){var t=e.sourceLink,n=e.timePeriod,c=Object(a.useState)(!1),o=Object(b.a)(c,2),l=o[0],u=o[1],i=Object(a.useCallback)((function(){u(!0)}),[u]),s=function(e){if(!e)return[0,1/0];var t=e.split(" - "),n=Object(b.a)(t,2),a=n[0],r=n[1];return[D(a),D(r)]}(n),m=Object(b.a)(s,2),f=m[0],p=m[1],v=function(e){var t;try{t=new URL(e)}catch(a){t=new URL(e.match(/[^[](\S+)(?=])/gi)[0])}var n=t.search;return d.a.parse(n.slice(1)).v}(t),h=Object(a.useRef)(null),E=Object(a.useRef)(!1),j=Object(a.useCallback)((function(e){var t;e.playedSeconds>p&&e.playedSeconds-p<2&&!E.current&&((null===(t=h.current)||void 0===t?void 0:t.getInternalPlayer()).pauseVideo(),E.current=!0)}),[p,E]);return r.a.createElement(V,null,l?r.a.createElement(U.a,{ref:h,url:"https://www.youtube.com/watch?v=".concat(v,"&start=").concat(f),controls:!0,onProgress:j}):r.a.createElement(_,{onClick:i},"Show video"))}));function M(){var e=Object(l.a)(["\n  font-size: 0.7em;\n"]);return M=function(){return e},e}function N(){var e=Object(l.a)(["\n  opacity: 0.75;\n  font-size: 0.8em;\n  padding-bottom: 5px;\n  border-bottom: 1px solid black;\n"]);return N=function(){return e},e}function G(){var e=Object(l.a)(["\n  display: flex;\n  justify-content: space-between;\n"]);return G=function(){return e},e}function J(){var e=Object(l.a)(["\n  margin: 0;\n\n  > a + a {\n    margin-left: 5px;\n  }\n"]);return J=function(){return e},e}function H(){var e=Object(l.a)(["\n  border: 1px solid black;\n  padding: 10px;\n  border-radius: 8px;\n  margin-bottom: 15px;\n"]);return H=function(){return e},e}var q=s.b.div(H()),K=s.b.p(J()),Q=s.b.div(G()),W=s.b.p(N()),X=s.b.span(M()),Y=Object(a.memo)((function(e){var t,n=e.result,c=e.vote,o=Object(a.useState)(""),l=Object(b.a)(o,2),i=l[0],s=l[1];Object(a.useEffect)((function(){1===c?s("up"):-1===c&&s("down")}),[c]);var m=Object(a.useCallback)((function(){var e;(e=n.id,v.put("knowledgeblocks/".concat(e,"/actions/upvote"))).then((function(){return s("up")}))}),[n]),d=Object(a.useCallback)((function(){var e;(e=n.id,v.put("knowledgeblocks/".concat(e,"/actions/downvote"))).then((function(){return s("down")}))}),[n]);return r.a.createElement(q,null,r.a.createElement(Q,null,r.a.createElement(K,null,"Category: ",n.attributes.semantics),r.a.createElement(K,null,r.a.createElement(u.b,{to:"/note-editor?id=".concat(n.id)},r.a.createElement("button",null,"Edit")),r.a.createElement(u.b,{to:"/notes/knowledge-block?id=".concat(n.id)},"Permalink"))),r.a.createElement(W,null,n.path.slice(1).map((function(e){return e.title})).join(" - ")),r.a.createElement(Q,null,n.attributes.sourceAuthor&&r.a.createElement(X,null,"Author: ",n.attributes.sourceAuthor),n.attributes.timePeriod&&r.a.createElement(X,null,"Relevant section: ",n.attributes.timePeriod)),r.a.createElement(A,{input:n.text}),(null===(t=n.attributes.sourceLink)||void 0===t?void 0:t.includes("youtube.com"))&&r.a.createElement(F,{sourceLink:n.attributes.sourceLink,timePeriod:n.attributes.timePeriod}),r.a.createElement("hr",null),r.a.createElement(Q,null,r.a.createElement("div",null,r.a.createElement("p",null,"Upvotes:"," ",n.upVotes+("up"===i&&1!==c?1:"down"===i&&1===c?-1:0)),r.a.createElement("p",null,"Downvotes:"," ",n.downVotes+("down"===i&&-1!==c?1:"up"===i&&-1===c?-1:0))),r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("button",{onClick:m,disabled:"up"===i},"\u2191")),r.a.createElement("p",null,r.a.createElement("button",{onClick:d,disabled:"down"===i},"\u2193")))))}));function Z(){var e=Object(l.a)(["\n  margin-left: 8px;\n  width: 60%;\n"]);return Z=function(){return e},e}function $(){var e=Object(l.a)(["\n  width: 100%;\n  height: 300px;\n"]);return $=function(){return e},e}function ee(){var e=Object(l.a)(["\n  margin-left: 8px;\n  max-width: 60%;\n"]);return ee=function(){return e},e}function te(){var e=Object(l.a)(["\n  display: block;\n  margin-bottom: 5px;\n"]);return te=function(){return e},e}function ne(){var e=Object(l.a)(["\n  border-bottom: 1px solid black;\n  padding-bottom: 15px;\n  margin-bottom: 15px;\n"]);return ne=function(){return e},e}function ae(){var e=Object(l.a)(["\n  margin: 0 auto;\n  width: 800px;\n"]);return ae=function(){return e},e}var re=s.b.div(ae()),ce=s.b.form(ne()),oe=s.b.label(te()),le=s.b.select(ee()),ue=s.b.textarea($()),ie=s.b.input(Z()),se=function(e){var t,n=e.votes,c=Object(i.h)().search,o=d.a.parse(c.slice(1)).id,l=Object(a.useState)(null),u=Object(b.a)(l,2),s=u[0],m=u[1],f=Object(a.useState)("loading"),p=Object(b.a)(f,2),v=p[0],h=p[1];return Object(a.useEffect)((function(){j(o).then(m).then((function(){return h("success")})).catch((function(e){console.error(e),h("error")}))}),[o]),r.a.createElement(re,null,r.a.createElement(x,{loadingState:v,withTokenLink:!0},r.a.createElement(Y,{result:s,vote:null===(t=n.find((function(e){return e.knowledgeBlockId===(null===s||void 0===s?void 0:s.id)})))||void 0===t?void 0:t.vote})))},be=Object(a.memo)((function(e){var t=e.topic,n=e.seniority,c=e.votes,o=Object(a.useState)([]),l=Object(b.a)(o,2),u=l[0],i=l[1],s=Object(a.useState)("loading"),m=Object(b.a)(s,2),d=m[0],f=m[1];return Object(a.useEffect)((function(){(function(e,t){return v.get("knowledgeblocks",{params:{title:e,level:null===t||void 0===t?void 0:t.toUpperCase()}}).then((function(e){return e.data.knowledgeBlockList}))})(t,n).then(i).then((function(){return f("success")})).catch((function(e){console.error(e),f("error")}))}),[t,n]),r.a.createElement(re,null,r.a.createElement(x,{loadingState:d},u.length>0?u.map((function(e){var t;return r.a.createElement(Y,{key:e.id,result:e,vote:null===(t=c.find((function(t){return t.knowledgeBlockId===e.id})))||void 0===t?void 0:t.vote})})):r.a.createElement("p",null,r.a.createElement("em",null,"No results found :("))))})),me=function(e){return function(t){e(t.currentTarget.value)}};function de(){var e=Object(l.a)(["\n  margin-left: 10px;\n"]);return de=function(){return e},e}var fe=s.b.button(de()),pe=function(){var e=Object(i.g)(),t=d.a.parse(e.location.search.slice(1)),n=t.topic,c=t.seniority,o=Object(a.useState)([]),l=Object(b.a)(o,2),u=l[0],s=l[1],m=Object(a.useState)(null!==n&&void 0!==n?n:""),f=Object(b.a)(m,2),p=f[0],v=f[1],h=Object(a.useState)("loading"),j=Object(b.a)(h,2),O=j[0],g=j[1],w=Object(a.useState)(null!==c&&void 0!==c?c:""),C=Object(b.a)(w,2),I=C[0],L=C[1],P=Object(a.useState)([]),T=Object(b.a)(P,2),A=T[0],R=T[1];Object(a.useEffect)((function(){E().then(S).then(s).then(k).then(R).then((function(){return g("success")})).catch((function(e){console.error(e),g("error")}))}),[]);var U=Object(a.useCallback)((function(t){t.preventDefault();var n={topic:p,seniority:I};Object.entries(n).forEach((function(e){var t=Object(b.a)(e,2),a=t[0];t[1]||delete n[a]})),e.push("/notes/search?".concat(d.a.stringify(n)))}),[e,I,p]),z=Object(a.useCallback)((function(){L(""),v("")}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Architect Notes"),r.a.createElement(x,{loadingState:O,withTokenLink:!0},r.a.createElement(ce,{onSubmit:U},r.a.createElement(oe,null,"Select topic:",r.a.createElement(le,{value:p,onChange:me(v)},r.a.createElement("option",{value:"",disabled:!0},"Topic"),u.map((function(e){return r.a.createElement("option",{key:e.id,value:e.title},"".concat("--".repeat(e.depth)," ").concat(e.title))})))),r.a.createElement(oe,null,"Select seniority level:",r.a.createElement(le,{value:I,onChange:me(L)},r.a.createElement("option",{value:"",disabled:!0},"Seniority"),y.map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",null,r.a.createElement("button",{disabled:!p},"Search"),r.a.createElement(i.b,{path:"/notes/search"},r.a.createElement(fe,{onClick:z},"Clear"))))),r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/notes/search"},n?r.a.createElement(be,{topic:n,seniority:c,votes:A}):r.a.createElement(i.a,{to:"/notes"})),r.a.createElement(i.b,{path:"/notes/knowledge-block"},r.a.createElement(se,{votes:A})),r.a.createElement(i.b,{path:"*"},r.a.createElement(i.a,{to:"/notes"}))))},ve=function(){var e;return null!==(e=localStorage.getItem("token"))&&void 0!==e?e:""},he=ve();he&&h(he);var Ee=function(){var e=Object(a.useState)(ve()),t=Object(b.a)(e,2),n=t[0],c=t[1],o=Object(i.g)(),l=Object(a.useCallback)((function(){!function(e){localStorage.setItem("token",e),h(e)}(n),o.replace("/notes")}),[n,o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("ol",null,r.a.createElement("li",null,"Visit"," ",r.a.createElement("a",{href:"http://localhost:5050/",target:"_blank",rel:"noopener noreferrer"},"this link")," ","and login with your Google account"),r.a.createElement("li",null,r.a.createElement("a",{href:"http://localhost:5050/api/authenticate",target:"_blank",rel:"noopener noreferrer"},"Click here")),r.a.createElement("li",null,"Paste the token below")),r.a.createElement(ue,{value:n,onChange:me(c)}),r.a.createElement("button",{type:"button",onClick:l},"Save"))},je=n(64),Oe=n.n(je),ge=function(){var e=Object(i.g)(),t=Object(i.h)().search,n=d.a.parse(t.slice(1)).id,c=Object(a.useState)([]),o=Object(b.a)(c,2),l=o[0],u=o[1],s=Object(a.useState)(""),m=Object(b.a)(s,2),f=m[0],p=m[1],v=Object(a.useState)(""),h=Object(b.a)(v,2),k=h[0],w=h[1],C=Object(a.useState)(""),I=Object(b.a)(C,2),L=I[0],P=I[1],T=Object(a.useState)(""),A=Object(b.a)(T,2),R=A[0],U=A[1],z=Object(a.useState)("loading"),B=Object(b.a)(z,2),V=B[0],_=B[1],D=Object(a.useState)(""),F=Object(b.a)(D,2),M=F[0],N=F[1];Object(a.useEffect)((function(){E().then(S).then((function(e){return u(e),e})).then((function(e){if(n)return j(n).then((function(t){p(e.find((function(e){return e.id===t.path[t.path.length-1].id})).title),w("@@ MISSING TITLE @@"),P(t.text),U(t.attributes.semantics.toLowerCase()),N(t.attributes.level.toLowerCase())}))})).then((function(){return _("success")})).catch((function(e){console.error(e),_("error")}))}),[n]);var G=Object(a.useCallback)((function(t){if(t.preventDefault(),f&&k&&L&&R&&M){var a=n?g:O,r={id:n,parentId:l.find((function(e){return e.title===f})).id.toString(),title:k,text:L,category:R,seniority:M.toUpperCase(),sourceAuthor:Oe()(ve()).name};n||delete r.id,a(r).then((function(t){e.push("/notes/knowledge-block?id=".concat(null!==n&&void 0!==n?n:t.id))})).catch((function(e){return console.error(e)}))}}),[R,e,n,M,f,L,k,l]);return r.a.createElement(x,{loadingState:V,withTokenLink:!0},r.a.createElement(ce,{onSubmit:G},r.a.createElement(oe,null,"Select topic:",r.a.createElement(le,{value:f,onChange:me(p)},r.a.createElement("option",{value:"",disabled:!0},"Topic"),l.map((function(e){return r.a.createElement("option",{key:e.id,value:e.title},"".concat("--".repeat(e.depth)," ").concat(e.title))})))),r.a.createElement(oe,null,"Select seniority level:",r.a.createElement(le,{value:M,onChange:me(N)},r.a.createElement("option",{value:"",disabled:!0},"Seniority"),y.map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement(oe,null,"Title:",r.a.createElement(ie,{value:k,onChange:me(w)})),r.a.createElement(oe,null,"Text (markdown):",r.a.createElement(ue,{value:L,onChange:me(P)})),r.a.createElement(oe,null,"Category:",r.a.createElement(ie,{value:R,onChange:me(U)})),r.a.createElement("button",{type:"submit"},"Save"),r.a.createElement("p",null,"All fields are mandatory.")))};function ke(){var e=Object(l.a)(["\n  body {\n    font-family: Montserrat, 'sans-serif';\n  }\n"]);return ke=function(){return e},e}var we=Object(s.a)(ke());o.a.render(r.a.createElement((function(){return r.a.createElement(u.a,null,r.a.createElement(we,null),r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(u.b,{to:"/notes"},"View notes")),r.a.createElement("p",null,r.a.createElement(u.b,{to:"/note-editor"},"Create note"))),r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/token",component:Ee}),r.a.createElement(i.b,{path:"/notes",component:pe}),r.a.createElement(i.b,{path:"/note-editor",component:ge}),r.a.createElement(i.b,{path:"*"},r.a.createElement(i.a,{to:"/token"}))))}),null),document.getElementById("root"))},66:function(e,t,n){e.exports=n(103)}},[[66,1,2]]]);
//# sourceMappingURL=main.22a19de6.chunk.js.map